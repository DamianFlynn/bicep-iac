{ // All Network Flows From A Source IP
  "displayName": "All Network Flows From A Source IP",
  "name": "f7fa1050-6ab7-46ab-82a5-f51e671f31ef",
  "category": "VDC - Azure Firewall",
  "query": "AzureDiagnostics | where Category == 'AzureFirewallNetworkRule' | parse msg_s with Protocol ' request from ' SourceIP ':' SourcePortInt:int ' to ' TargetIP ':' TargetPortInt:int * | parse msg_s with * '. Action: ' Action1a | parse msg_s with * ' was ' Action1b ' to ' NatDestination | parse msg_s with Protocol2 ' request from ' SourceIP2 ' to ' TargetIP2 '. Action: ' Action2 | extend SourcePort = tostring(SourcePortInt),TargetPort = tostring(TargetPortInt) | extend Action = case(Action1a == '', case(Action1b == '',Action2,Action1b), Action1a),Protocol = case(Protocol == '', Protocol2, Protocol),SourceIP = case(SourceIP == '', SourceIP2, SourceIP),TargetIP = case(TargetIP == '', TargetIP2, TargetIP),SourcePort = case(SourcePort == '', 'N/A', SourcePort),TargetPort = case(TargetPort == '', 'N/A', TargetPort),NatDestination = case(NatDestination == '', 'N/A', NatDestination) | where SourceIP == '10.0.0.1' | project TimeGenerated, msg_s, Protocol, SourceIP,SourcePort,TargetIP,TargetPort,Action, NatDestination | sort by TimeGenerated desc"
}